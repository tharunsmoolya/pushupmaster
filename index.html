<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Push Up Progress</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <!-- SweetAlert2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <!-- SweetAlert2 JS -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@400;600&family=Roboto+Slab:wght@600&display=swap" rel="stylesheet">


  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    body { background: #f8f9fa; }
    .hidden { display: none; }
    .quote { font-style: italic; color: #555; }
    .exercise-card { min-height: 100%; }

   /* Full-page loader overlay */
#loaderOverlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  display: none;
  z-index: 9999;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #fff;
  font-family: 'Orbitron', sans-serif;
  text-align: center;
  padding: 20px;
}

/* Circular pulse animation */
#loaderOverlay .pulse-circle {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: linear-gradient(135deg, #ff6b6b, #feca57);
  animation: pulse 1.5s infinite;
  margin-bottom: 20px;
}

@keyframes pulse {
  0% { transform: scale(0.9); opacity: 0.7; }
  50% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(0.9); opacity: 0.7; }
}

/* Striped progress bar */
#loaderOverlay .progress {
  width: 200px;
  height: 12px;
  background: rgba(255,255,255,0.2);
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 15px;
}

#loaderOverlay .progress-bar {
  width: 0%;
  height: 100%;
  background: repeating-linear-gradient(
    45deg,
    #06d6a0,
    #06d6a0 10px,
    #118ab2 10px,
    #118ab2 20px
  );
  animation: loadStripe 2s linear infinite, loadGrow 5s ease forwards;
}

@keyframes loadStripe {
  0% { background-position: 0 0; }
  100% { background-position: 40px 0; }
}

@keyframes loadGrow {
  from { width: 0%; }
  to { width: 100%; }
}

/* Text animation */
#loaderOverlay .loader-text {
  font-size: 1.3rem;
  font-weight: bold;
  animation: textPulse 1.5s infinite;
}

@keyframes textPulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

    /* Floating label with icons fix */
    .form-floating input {
      padding-left: 2.2rem !important;
    }
    .form-floating label {
      left: 2.2rem;
    }

    #motivation {
  font-family: 'Orbitron', sans-serif;
  font-size: 1.1rem;
  font-weight: bold;
  text-align: center;
  margin: 10px 0;
  transition: opacity 0.8s ease;
  color: #333;
}

#motivation.highlight {
  color: #e63946;
  text-shadow: 0 0 8px rgba(230,57,70,0.6);
}


    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 576px) {
      h2, h3, h4 { font-size: 1.2rem; }
      h5 { font-size: 1rem; }
      .input-group input { font-size: 0.9rem; }
      .btn { font-size: 0.85rem; padding: 0.4rem 0.6rem; }
    }
    /* Ensure header is always on top */
    .sticky-top {
      position: sticky;
      top: 0;
    }

    /* Smooth width transition for progress bar */
    #scrollProgress {
      transition: width 0.2s ease-out;
    }
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap');

.section-title {
  font-family: 'Poppins', sans-serif;
  font-weight: 700;
  font-size: 1.5rem;
  color: #0072ff;
  border-bottom: 3px solid #0072ff;
  display: inline-block;
  padding-bottom: 4px;
}

.calendar-wrapper {
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 20px;
}

#slideshow {
  background: linear-gradient(135deg, #00c6ff, #0072ff);
  color: white;
}

#slideshow-img:hover {
  transform: scale(1.05);
  cursor: pointer;
}

@media (max-width: 767px) {
  #slideshow-img {
    max-height: 200px;
  }
}

  .calendar-table td {
    height: 50px;
    vertical-align: middle;
  }

  .day-circle {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    font-weight: 600;
  }

  .legend-box {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 3px;
    margin-right: 4px;
  }

/* Logout Loader Overlay */
#logoutLoader {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.85);
  display: none;
  z-index: 10000;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #fff;
  font-family: 'Orbitron', sans-serif;
  text-align: center;
}

#logoutLoader .cube {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #f77f00, #e63946);
  animation: rotateCube 1.2s infinite ease-in-out;
  transform-origin: center;
  margin-bottom: 15px;
}

#logoutLoader .loader-text {
  font-size: 1.2rem;
  font-weight: bold;
  animation: fadePulse 1.5s infinite;
}

@keyframes rotateCube {
  0%, 100% { transform: rotateX(0deg) rotateY(0deg); }
  25% { transform: rotateX(180deg) rotateY(0deg); }
  50% { transform: rotateX(180deg) rotateY(180deg); }
  75% { transform: rotateX(0deg) rotateY(180deg); }
}

@keyframes fadePulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
  </style>
</head>
<body>

<div id="loaderOverlay">
  <div class="pulse-circle"></div>
  <div class="progress"><div class="progress-bar"></div></div>
  <div class="loader-text">🔥 Getting You Ready...</div>
</div>

<div id="logoutLoader">
  <div class="cube"></div>
  <div class="loader-text">🚪 Logging you out...</div>
</div>

<div id="loader-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
  <div class="spinner" style="border:8px solid #f3f3f3; border-top:8px solid #06d6a0; border-radius:50%; width:60px; height:60px; animation:spin 1s linear infinite;"></div>
</div>

<div class="container-fluid py-3">
<!-- Login Page -->
<div id="loginPage" class="row justify-content-center align-items-center min-vh-100"
     style="background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), 
            url('https://images.unsplash.com/photo-1605296867304-46d5465a13f1?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') 
            center/cover no-repeat;">
  <div class="col-12 col-sm-10 col-md-6 col-lg-4">
    <div class="card shadow-lg border-0 rounded-4" style="background: rgba(255,255,255,0.9);">
      <div class="card-body p-4">
        
        <!-- Title -->
        <h2 class="text-center fw-bold mb-2" 
            style="font-family: 'Orbitron', sans-serif; color:#e63946;">
          Push Up Progress
        </h2>
        <p class="text-center text-muted fst-italic mb-4" style="font-size: 0.9rem;">
          "You can You Will"
        </p>

        <!-- Username Field -->
        <div class="form-floating mb-3 position-relative">
          <span class="position-absolute top-50 translate-middle-y ms-3 text-muted">
            <i class="bi bi-person"></i>
          </span>
          <input type="text" id="username" class="form-control ps-5 rounded-pill" placeholder="Username">
          <label for="username">Username</label>
        </div>

        <!-- Password Field -->
        <div class="form-floating mb-3 position-relative">
          <span class="position-absolute top-50 translate-middle-y ms-3 text-muted">
            <i class="bi bi-lock"></i>
          </span>
          <input type="password" id="password" class="form-control ps-5 rounded-pill" placeholder="Password">
          <label for="password">Password</label>
          <button type="button"
                  class="btn btn-sm position-absolute top-50 end-0 translate-middle-y me-2"
                  onclick="togglePassword()"
                  style="border:none; background:transparent; color:#e63946;">
            <i id="eyeIcon" class="bi bi-eye"></i>
          </button>
        </div>

        <!-- Login Button -->
        <button id="loginBtn" 
                class="btn w-100 rounded-pill py-2 fw-bold text-white"
                style="background: linear-gradient(45deg, #e63946, #f77f00); border:none;"
                onclick="login()">
          Login
        </button>

        <!-- Error Message -->
        <p id="loginError" class="text-danger mt-2 text-center fw-bold"></p>
      </div>
    </div>
  </div>
</div>


  <!-- Dashboard -->
  <div id="dashboard" class="hidden">
    <!-- Dashboard Header -->
    <!-- Sticky Header with Progress Bar -->
<div id="dashboardHeader" class="sticky-top shadow-sm" style="z-index: 1030;">
  <!-- Gradient Header -->
  <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center p-3 mb-0 rounded"
       style="background: linear-gradient(90deg, #e63946, #f77f00); color: #fff; font-family: 'Orbitron', sans-serif;">

    <!-- Title -->
    <h2 class="mb-2 mb-sm-0 fw-bold text-center text-sm-start">
      🚀 Push Up Progress Dashboard
    </h2>

    <!-- Buttons -->
    <div class="d-flex gap-2">
      <button class="btn btn-light btn-sm px-3 shadow-sm rounded-pill fw-bold" 
              style="color:#e63946;"
              onclick="logout()">
        <i class="bi bi-box-arrow-right me-1"></i> Logout
      </button>
      <button class="btn btn-sm px-3 shadow-sm rounded-pill fw-bold text-white"
              style="background: linear-gradient(45deg, #f77f00, #ffba08); border:none;"
              onclick="resetProgress()">
        <i class="bi bi-arrow-counterclockwise me-1"></i> Reset
      </button>
    </div>
  </div>

  <!-- Scroll Progress Bar -->
  <div class="progress" style="height: 6px; margin:0; border-radius:0;">
    <div id="scrollProgress" 
         class="progress-bar" 
         style="width:0%; background: linear-gradient(90deg, #06d6a0, #118ab2);">
    </div>
  </div>
</div>


    <div class="alert alert-info small text-center">
      <span id="motivation" class="quote"></span>
    </div>

    <div id="statsSection" class="mb-4"></div>
    <div id="masteredSection"></div>
    <div id="levelSection"></div>
    
    <div class="row gx-4 gy-4">
  <!-- Calendar Column -->
  <div class="col-md-6">
    <h4 class="section-title mb-3">🔥 Workout Streak Calendar</h4>
    <div id="calendar" class="calendar-wrapper p-3 shadow-sm rounded-4 bg-white"></div>
  </div>

  <div class="col-md-6">
  <h4 class="section-title mb-3">💡 Motivation</h4>
  <div id="slideshow" class="card shadow-sm rounded-4 overflow-hidden bg-primary bg-gradient" style="border: none; min-height: 300px;">
    <div class="card-body d-flex justify-content-center align-items-center p-0">
      <img id="slideshow-img" src="images/first.png" class="img-fluid rounded-3 shadow-lg" alt="Motivation Slide" 
           style="width: 100%; height: 100%;">
    </div>
  </div>
</div>



    <h4 class="mt-4">Workout Logs</h4>
    <div id="logs" class="mb-5"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const CREDENTIALS = { username: "user", password: "pushmaster" };
const QUOTES = [
  "🔥 Every rep takes you closer to greatness!",
  "💪 Discipline today, strength tomorrow.",
  "🚀 Push harder than yesterday if you want a different tomorrow.",
  "⏳ Consistency beats motivation — show up daily!",
  "🏆 Champions are built, not born.",
  "🙌 Your only competition is who you were yesterday.",
  "⚡ Strength doesn’t come from what you can do, it comes from overcoming the impossible.",
  "🦾 One more pushup = one step stronger.",
  "🌟 Small progress is still progress. Keep going!",
  "💥 Sweat now, shine later.",
  "🏋️‍♂️ Pain is temporary, pride is forever.",
  "⚡ Push beyond limits and surprises await!",
  "🔥 Every drop of sweat is a step closer to mastery.",
  "💪 Stronger every day, one rep at a time.",
  "🏆 Don’t count the reps, make the reps count.",
  "🚀 Your body can stand almost anything — it’s your mind you have to convince.",
  "🌟 Success starts with showing up, even when it’s tough.",
  "🦾 Push, persist, prevail.",
  "💥 No shortcuts. Only hard work and dedication.",
  "🔥 Today’s pain is tomorrow’s power.",
  "💪 Strength grows in the moments you think you can’t go on but do.",
  "⚡ The harder you push, the higher you rise.",
  "🏆 Every mastered push-up is a victory over laziness.",
  "🙌 Champions train when no one is watching.",
  "🚀 One push-up today, a hundred tomorrow.",
  "🌟 Focus, sweat, repeat.",
  "💥 Your limits are only in your mind.",
  "🦾 Pain is the alarm clock to greatness.",
  "🔥 Struggle today, flex tomorrow.",
  "💪 You don’t find willpower, you build it.",
  "⚡ Push-ups don’t build only muscles, they build discipline.",
  "🏆 Strength is earned rep by rep.",
  "🙌 Every set is a step closer to your best self.",
  "🚀 Don’t stop when it hurts, stop when you’re proud.",
  "🌟 Hard work beats talent when talent doesn’t work hard.",
  "💥 The only bad workout is the one you didn’t do.",
  "🦾 Sweat, smile, repeat.",
  "🔥 Your body can do it. Your mind has to convince you.",
  "💪 Reps build resilience.",
  "⚡ Mastery comes from repetition.",
  "🏆 Today’s effort = tomorrow’s results.",
  "🙌 Push-ups today, victories tomorrow.",
  "🚀 Turn excuses into push-ups.",
  "🌟 Fitness is the reward, consistency is the key.",
  "💥 Strength is built when you refuse to quit.",
  "🦾 One more set, one step stronger.",
  "🔥 Don’t wait for motivation. Create it.",
  "💪 Challenge yourself or remain the same.",
  "⚡ Sweat is the body’s applause for effort.",
  "🏆 Train insane or remain the same.",
  "🙌 Discipline > motivation, every time.",
  "🚀 The road to strength is paved with push-ups.",
  "🌟 Push past fatigue, greatness awaits.",
  "💥 One rep closer to the best version of yourself."
];

const LEVELS = [
  {
    name: "Beginner (Foundation)",
    criteria: "Start here if you’re new. Goal: build base strength with perfect form.",
    exercises: [
      {
        id: "wall",
        title: "Wall Push-Up",
        notes: "Stand arm’s length from wall, push chest to wall and back. Great first step. (Goal: 2×15 reps)",
        video: "https://youtu.be/YB0egDzsu18?si=H31k22ueaPzYro1Q"
      },
      {
        id: "incline",
        title: "Incline Push-Up",
        notes: "Hands on elevated surface (bench/table). Easier than floor push-ups. (Goal: 2×15 reps)",
        video: "https://youtu.be/Me9bHFAxnCs?si=YAEhy4vhAkp1PWh_"
      },
      {
        id: "knee",
        title: "Knee Push-Up",
        notes: "Knees on floor, straight line head-to-knees, lower chest fully. (Goal: 3×15 reps with perfect form)",
        video: "https://youtu.be/bwWlK8f1-NM?si=Ud2vK2vaGgkt48dv"
      }
    ]
  },
  {
    name: "Standard (Novice)",
    criteria: "Move on when you can do 3×12 knee/incline pushups with form.",
    exercises: [
      {
        id: "slow",
        title: "Slow Eccentric Push-Up",
        notes: "Lower slowly (3–5 seconds), then push up normally. Builds control. (Goal: 3×12 reps slowly)",
        video: "https://youtu.be/DP7yVuyfcSY?si=rCwOKrf8-88TdseR"
      },
      {
        id: "standard",
        title: "Standard Push-Up",
        notes: "Hands shoulder-width, core tight, chest to floor, lock elbows at top. (Goal: 3×12 reps)",
        video: "https://youtu.be/IODxDxX7oi4?si=5YXZGhEznG41oG7D"
      },
      {
        id: "wide",
        title: "Wide Push-Up",
        notes: "Hands placed wider than shoulders. Hits outer chest. (Goal: 3×12 reps)",
        video: "https://youtu.be/m3FTgWtJsFE?si=8VqQ7ashc9fC1K-w"
      },
      {
        id: "close",
        title: "Close-Grip Push-Up",
        notes: "Hands under chest, triceps focus. Elbows stay close to body. (Goal: 3×12 reps)",
        video: "https://youtu.be/aWixj7ey758?si=PqMTvoFZPqDIL1-V"
      }
    ]
  },
  {
    name: "Intermediate",
    criteria: "Strong in standard form. Start exploring harder variations.",
    exercises: [
      {
        id: "kneediamond",
        title: "Knee Diamond Push-Up",
        notes: "Hands form a diamond under chest. Intense triceps/inner chest work. (Goal: 3×10 reps)",
        video: "https://youtu.be/dmoHFWt-Mms?si=pz2tWGyfqU-P0_zg"
      },
      {
        id: "diamond",
        title: "Diamond Push-Up",
        notes: "Hands form a diamond under chest. Intense triceps/inner chest work. (Goal: 3×12 reps)",
        video: "https://youtu.be/UCmqw3kKZ38?si=g-wcfh80D3wO9LDu"
      },
      {
        id: "decline",
        title: "Decline Push-Up",
        notes: "Feet elevated. Increases difficulty and targets upper chest. (Goal: 3×10 reps)",
        video: "https://youtu.be/OjPfLfLsw3c?si=khZ8Q0rpbKktl2QB"
      },
      {
        id: "archer",
        title: "Archer Push-Up",
        notes: "One arm bends while the other stays straight. Builds one-arm strength. (Goal: 3×8 reps per side)",
        video: "https://youtu.be/OVRBYrjszy4?si=1W4DPXMnHcdbIpqa"
      },
      {
        id: "pseudo",
        title: "Pseudo Planche Push-Up",
        notes: "Hands placed lower near waist, lean forward to increase difficulty. (Goal: 3×8 reps)",
        video: "https://youtu.be/lpZUsYQVwuE?si=p8AfSIO_uCm4-phv"
      },
      {
        id: "spiderman",
        title: "Spiderman Push-Up",
        notes: "Bring knee to elbow as you descend. Core + chest challenge. (Goal: 3×10 reps)",
        video: "https://youtu.be/FbIrd0_4X1w?si=Tm1kOTGPPpck6Yb3"
      }
    ]
  },
  {
    name: "Advanced",
    criteria: "Push explosiveness, balance, and unilateral strength.",
    exercises: [
      {
        id: "plyo",
        title: "Plyometric (Clap) Push-Up",
        notes: "Explosive push-off with clap. Power and fast-twitch muscles. (Goal: 3×8 reps)",
        video: "https://youtu.be/FRo3b_Pfw3M?si=UXR_bnEWa_K9MAld"
      },
      {
        id: "typewriter",
        title: "Typewriter Push-Up",
        notes: "Go down to one side, shift across, and push up. Archer + movement. (Goal: 3×6 reps per side)",
        video: "https://youtu.be/OoFHIWmNM_A?si=qdQVJkkJmKLOIl-O"
      },
      {
        id: "onearm",
        title: "One-Arm Push-Up",
        notes: "Work up with assisted, archer, and decline before strict form. (Goal: 3×5 reps per arm)",
        video: "https://youtu.be/xvOoZ3SbKCw?si=upacRv1uwIz6JMzf"
      },
      {
        id: "tigerbend",
        title: "Tiger Bend Push-Up",
        notes: "Start on forearms, press up into push-up. Triceps + shoulders burn. (Goal: 3×6 reps)",
        video: "https://youtu.be/wjIZTDc-oZc?si=-0SmtifHfJnq0PHN"
      },
      {
        id: "explosive",
        title: "Explosive Superman Push-Up",
        notes: "Launch fully off ground, extend arms forward. Very advanced. (Goal: 3×5 reps)",
        video: "https://youtu.be/3UKg6j31OMI?si=qx-nFXfHeXgINmCK"
      }
    ]
  },
  {
    name: "Elite",
    criteria: "Master advanced variations, chase gymnastic-level control.",
    exercises: [
      {
        id: "planche",
        title: "Planche Push-Up",
        notes: "Lean heavily forward until feet lift. Requires insane wrist/core strength. (Goal: 3×3 reps)",
        video: "https://youtu.be/A9tJDvRcqjE?si=SXSs4rxMn0KYh0PE"
      },
      {
        id: "handstand",
        title: "Handstand Push-Up",
        notes: "Do against a wall → then freestanding. Shoulders focus. (Goal: 3×3 reps)",
        video: "https://youtu.be/pYx7CRs7kAM?si=F5eI4b0ibnGHqAdp"
      },
      {
        id: "90degree",
        title: "90-Degree Push-Up",
        notes: "From handstand, lower into planche, then push back. Gymnast level. (Goal: 3×3 reps)",
        video: "https://youtu.be/LH6acDN02Sw?si=9OQJ5RB_W1q8JzQz"
      },
      {
        id: "aztec",
        title: "Aztec Push-Up",
        notes: "Explosive push → touch hands to feet mid-air. Extreme plyo skill. (Goal: 3×3 reps)",
        video: "https://youtu.be/4zsi1xn33vM?si=Z0cVlzzoKKv0k7OQ"
      },
      {
        id: "onearmhandstand",
        title: "One-Arm Handstand Push-Up",
        notes: "Peak balance + pushing strength. Final boss of push-ups. (Goal: 3×2 reps)",
        video: "https://youtube.com/shorts/ZIxWt6kJ2XU?si=WcUkEE7_urUK1Diy"
      }
    ]
  }
];


const MILESTONES = [
  { id: "standard", condition: u => u.logs.some(l=>l.exercise==="standard"), text: "First Push-Up" },
  { id: "100", condition: u => u.totalPushups >= 100, text: "100 Total Pushups" },
  { id: "500", condition: u => u.totalPushups >= 500, text: "500 Total Pushups" },
  { id: "1000", condition: u => u.totalPushups >= 1000, text: "1000 Total Pushups" },
  { id: "5000", condition: u => u.totalPushups >= 5000, text: "5000 Total Pushups" },
  { id: "10000", condition: u => u.totalPushups >= 10000, text: "10,000 Total Pushups" },
  { id: "diamond", condition: u => u.logs.some(l=>l.exercise==="diamond"), text: "First Diamond Push-Up" },
  { id: "onearm", condition: u => u.logs.some(l=>l.exercise==="onearm"), text: "First One-Arm Push-Up" },
  { id: "handstand", condition: u => u.logs.some(l=>l.exercise==="handstand"), text: "First Handstand Push-Up" },
  { id: "streak3", condition: u => u.streak >= 3, text: "3-Day Streak" },
  { id: "streak7", condition: u => u.streak >= 7, text: "7-Day Streak" },
  { id: "streak14", condition: u => u.streak >= 14, text: "2-Week Streak" },
  { id: "streak30", condition: u => u.streak >= 30, text: "30-Day Streak" },
  { id: "streak60", condition: u => u.streak >= 60, text: "60-Day Streak" },
  { id: "streak100", condition: u => u.streak >= 100, text: "100-Day Streak 💯" },
  { id: "streak365", condition: u => u.streak >= 365, text: "1-Year Daily Streak 🏆" }
];

// Define mastery thresholds per exercise
const MASTERY_THRESHOLDS = {
  wall:      { reps: 15, sets: 2 },
  incline:   { reps: 15, sets: 2 },
  knee:      { reps: 15, sets: 3 },
  slow:      { reps: 12, sets: 3 },
  standard:  { reps: 12, sets: 3 },
  wide:      { reps: 12, sets: 3 },
  close:     { reps: 12, sets: 3 },
  kneediamond: { reps: 12, sets: 3 },
  diamond:     { reps: 10, sets: 3 },
  decline:     { reps: 10, sets: 3 },
  archer:      { reps: 8, sets: 3 },
  pseudo:      { reps: 8, sets: 3 },
  spiderman:   { reps: 10, sets: 3 },
  plyo:        { reps: 8, sets: 3 },
  typewriter:  { reps: 6, sets: 3 },
  onearm:      { reps: 5, sets: 3 },
  tigerbend:   { reps: 6, sets: 3 },
  explosive:   { reps: 5, sets: 3 },
  planche:     { reps: 3, sets: 3 },
  handstand:   { reps: 3, sets: 3 },
  "90degree":  { reps: 3, sets: 3 },
  aztec:       { reps: 3, sets: 3 },
  onearmhandstand: { reps: 2, sets: 3 }
};

const images = [
    "images/first.png",
    "images/fivth.png",
    "images/fourth.png",
    "images/second.png",
    "images/six.png",
    "images/third.png"
  ];

  let currentIndex = 0;
  const slideshowImg = document.getElementById("slideshow-img");

  function showNextImage() {
    currentIndex = (currentIndex + 1) % images.length;
    slideshowImg.src = images[currentIndex];
  }

  // Auto change every 3 seconds
  setInterval(showNextImage, 3000);

// Add masteredExercises field
let user = JSON.parse(localStorage.getItem("pushUser")) || { loggedIn:false, level:0, logs:[], totalPushups:0, streak:0, lastWorkoutDate:null, milestones:{}, masteredExercises:[] };

function login() {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  const loaderOverlay = document.getElementById("loaderOverlay");
  const loginBtn = document.getElementById("loginBtn");
  document.getElementById("loginError").textContent = "";

  if(u === CREDENTIALS.username && p === CREDENTIALS.password){
    loaderOverlay.style.display = "flex";
    loginBtn.disabled = true;
    setTimeout(()=>{
      user.loggedIn = true;
      saveUser();
      loaderOverlay.style.display = "none";
      loginBtn.disabled = false;
      render();
      startAutoLogoutTimer();
    }, 1200);
  } else {
    document.getElementById("loginError").textContent = "Invalid credentials.";
  }
}


function logSession(exId){
  const reps=parseInt(document.getElementById(`reps-${exId}`).value)||0;
  const sets=parseInt(document.getElementById(`sets-${exId}`).value)||0;
  if(reps && sets){
    const total=reps*sets;
    const today=new Date().toDateString();
    user.logs.push({date:new Date().toISOString(),exercise:exId,reps,sets});
    user.totalPushups+=total;
    if(user.lastWorkoutDate===today){}
    else if(user.lastWorkoutDate===new Date(Date.now()-86400000).toDateString()){ user.streak+=1; }
    else{ user.streak=1; }
    user.lastWorkoutDate=today;
    checkMilestones();
    checkMastery(exId, reps, sets);
    saveUser();
    renderLogs();
    renderStats();
    checkPromotion();
  }
}

function checkMastery(exId, reps, sets){
  const threshold = MASTERY_THRESHOLDS[exId];
  if(!threshold) return; // safety fallback

  // check if mastery achieved
  if(reps >= threshold.reps && sets >= threshold.sets && !user.masteredExercises.includes(exId)){
    user.masteredExercises.push(exId);

    const ex = LEVELS.flatMap(lv => lv.exercises).find(e => e.id === exId);

    Swal.fire({
      icon: 'success',
      title: 'Mastered Push-Up!',
      html: `🏆 You mastered: <strong>${ex ? ex.title : exId}</strong> push-up!<br>Keep progressing!`,
      timer: 2500,
      showConfirmButton: false
    });

    saveUser();
    renderMastered();
    renderLevel();
  }
}

function logout() {
  const loader = document.getElementById("logoutLoader");
  loader.style.display = "flex";  // show logout loader

  setTimeout(() => {
    user.loggedIn = false;
    localStorage.setItem("pushUser", JSON.stringify(user));
    saveUser(); render();
    document.getElementById("dashboard").classList.add("hidden");
    document.getElementById("loginPage").classList.remove("hidden");

    loader.style.display = "none"; // hide loader
  }, 800); // adjust time for smooth effect
}


function resetProgress() {
  Swal.fire({
    title: "Reset Progress?",
    text: "This will permanently erase all your push-up logs and achievements.",
    icon: "warning",
    showCancelButton: true,
    confirmButtonColor: "#e63946",
    cancelButtonColor: "#6c757d",
    confirmButtonText: "Yes, Reset"
  }).then(result => {
    if(result.isConfirmed) {
      // Show loader
      document.getElementById("loader-overlay").style.display = "flex";

      setTimeout(() => {
        // Reset user data
        user = { 
          loggedIn:false, 
          level:0, 
          logs:[], 
          totalPushups:0, 
          streak:0, 
          lastWorkoutDate:null, 
          milestones:{}, 
          masteredExercises:[] 
        };
        localStorage.setItem("pushUser", JSON.stringify(user));

        // Hide loader
        document.getElementById("loader-overlay").style.display = "none";

        Swal.fire("Reset!", "Your progress has been cleared.", "success");
      }, 1000); // simulate delay for visual effect
    }
  });
}




function togglePassword() {
  const passwordInput = document.getElementById("password");
  const eyeIcon = document.getElementById("eyeIcon");
  if (passwordInput.type === "password") {
    passwordInput.type = "text";
    eyeIcon.classList.remove("bi-eye");
    eyeIcon.classList.add("bi-eye-slash");
  } else {
    passwordInput.type = "password";
    eyeIcon.classList.remove("bi-eye-slash");
    eyeIcon.classList.add("bi-eye");
  }
}


function checkPromotion() {
  const level = LEVELS[user.level];
  const allExIds = level.exercises.map(e => e.id);
  
  // Check if all exercises in this level are mastered
  const allMastered = allExIds.every(id => user.masteredExercises.includes(id));
  
  if (allMastered && user.level < LEVELS.length - 1) {
    user.level++;
    Swal.fire({
      icon: 'success',
      title: 'Level Up!',
      text: `🎉 Congrats! You have been promoted to: ${LEVELS[user.level].name}`,
      timer: 2500,         // auto-close after 2.5 seconds
      showConfirmButton: false
    });

    saveUser();
    render();
  }
}

window.addEventListener("load", () => {
  const calendarHeight = document.getElementById("calendar").offsetHeight;
  document.getElementById("slideshow-img").style.height = calendarHeight + "px";
});


function checkMilestones() {
  MILESTONES.forEach(ms => {
    if (ms.condition(user) && !user.milestones[ms.id]) {
      user.milestones[ms.id] = true;
      Swal.fire({
        icon: 'info',
        title: 'Milestone Unlocked!',
        text: `🏅 ${ms.text}`,
        timer: 2000,
        showConfirmButton: false
      });
    }
  });
}


function render(){
  document.getElementById("loginPage").classList.toggle("hidden", user.loggedIn);
  document.getElementById("dashboard").classList.toggle("hidden", !user.loggedIn);
  if(user.loggedIn){ renderMastered(); renderLevel(); renderLogs(); renderStats(); renderCalendar(); }
}

function renderMastered() {
  if (!user.masteredExercises) user.masteredExercises = [];
  const container = document.getElementById("masteredSection");

  if (!user.masteredExercises.length) {
    container.innerHTML = "";
    return;
  }

  let html = `
    <div class="card mb-4 shadow-sm border-0"
         style="background: rgba(255,255,255,0.9);
                backdrop-filter: blur(12px);
                border-radius:20px;
                box-shadow:0 8px 20px rgba(0,0,0,0.15);">
      <div style="background: linear-gradient(135deg,#43cea2,#185a9d);
                  color:white; padding:15px; border-radius:18px 18px 0 0;
                  font-family:'Orbitron', sans-serif;
                  text-align:center;">
        <h4 class="mb-0 fw-bold">🏅 Mastered Push-Ups</h4>
        <p class="small mb-0" style="font-style:italic;">Your trophy wall of strength</p>
      </div>

      <div class="card-body">
        <div class="row g-4">
  `;

  user.masteredExercises.forEach(id => {
    const ex = LEVELS.flatMap(lv => lv.exercises).find(e => e.id === id);
    if (ex) {
      html += `
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100 border-0 shadow-sm"
               style="border-radius:16px; transition:transform 0.25s, box-shadow 0.25s;"
               onmouseover="this.style.transform='translateY(-6px)'; this.style.boxShadow='0 10px 25px rgba(0,0,0,0.2)';"
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title text-success fw-bold"
                  style="font-family:'Poppins', sans-serif;">
                ${ex.title}
                <span class="badge bg-success ms-2">Mastered</span>
              </h5>
              <p class="card-text text-muted small flex-grow-1" 
                 style="font-family:'Roboto Slab', serif;">
                ${ex.notes}
              </p>
              <a href="${ex.video}" target="_blank" 
                 class="btn btn-outline-success btn-sm mt-2 align-self-start fw-bold"
                 style="border-radius:10px;">
                🎥 Watch Tutorial
              </a>
            </div>
          </div>
        </div>
      `;
    }
  });

  html += `
        </div>
      </div>
    </div>
  `;

  container.innerHTML = html;
}




function renderLevel() {
  const level = LEVELS[user.level];
  const exercisesToShow = level.exercises.filter(ex => !user.masteredExercises.includes(ex.id));

  let html = `
    <div class="card mb-4 shadow border-0">
      <div class="card-body">
        <h2 class="level-title mb-3 text-center">💪 ${level.name}</h2>
        <p class="level-rule text-center"><strong>Rule:</strong> ${level.criteria}</p>
        <div class="row g-4">
  `;

  exercisesToShow.forEach(ex => {
    html += `
      <div class="col-12 col-md-6 col-lg-4">
        <div class="exercise-card shadow h-100">
          <div class="exercise-header">
            <span>${ex.title}</span>
          </div>
          <div class="card-body d-flex flex-column">
            <p class="exercise-notes flex-grow-1">${ex.notes}</p>
            <a href="${ex.video}" target="_blank" 
               class="btn btn-tutorial mt-2">
              🎥 Tutorial
            </a>
            <div class="input-group input-group-sm mt-3">
              <span class="input-group-text">Sets</span>
              <input type="number" id="sets-${ex.id}" class="form-control text-center" min="1" placeholder="0">
              <span class="input-group-text">Reps</span>
              <input type="number" id="reps-${ex.id}" class="form-control text-center" min="1" placeholder="0">
              <button class="btn btn-log fw-bold" onclick="logSession('${ex.id}')">Log ✅</button>
            </div>
          </div>
        </div>
      </div>
    `;
  });

  html += `</div></div></div>`;
  document.getElementById("levelSection").innerHTML = html;

  // Inject CSS & fonts once
  if (!document.getElementById("levelCardStyles")) {
    const style = document.createElement("style");
    style.id = "levelCardStyles";
    style.textContent = `
      @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@300;500;700&display=swap');

      .level-title {
        font-family: 'Bebas Neue', sans-serif;
        font-size: 2.5rem;
        background: linear-gradient(90deg, #00c6ff, #0072ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      .level-rule {
        font-family: 'Poppins', sans-serif;
        font-size: 0.95rem;
        color: #666;
      }

      .exercise-card {
        border-radius: 15px;
        overflow: hidden;
        transition: transform 0.25s ease, box-shadow 0.25s ease;
      }

      .exercise-card:hover {
        transform: translateY(-6px) scale(1.02);
        box-shadow: 0 12px 25px rgba(0,0,0,0.2);
      }

      .exercise-header {
        background: linear-gradient(135deg, #43cea2, #185a9d);
        color: white;
        font-family: 'Poppins', sans-serif;
        font-weight: 600;
        padding: 10px;
        text-align: center;
        font-size: 1.2rem;
      }

      .exercise-notes {
        font-family: 'Poppins', sans-serif;
        font-size: 0.9rem;
        color: #444;
      }

      .btn-tutorial {
        background: #0072ff;
        color: white;
        font-weight: 600;
        border-radius: 25px;
        transition: background 0.3s ease;
      }

      .btn-tutorial:hover {
        background: #0056b3;
      }

      .btn-log {
        background: #28a745;
        color: white;
        border-radius: 10px;
        transition: all 0.2s ease;
      }

      .btn-log:hover {
        background: #218838;
        transform: scale(1.05);
      }
    `;
    document.head.appendChild(style);
  }
}


function renderLogs() {
  const todayStr = new Date().toDateString(); // e.g., "Wed Oct 01 2025"
  const todaysLogs = user.logs.filter(l => new Date(l.date).toDateString() === todayStr);

  const container = document.getElementById("logs");
  if (!todaysLogs.length) {
    container.innerHTML = `
      <div class="card shadow-sm mb-3" style="border-radius:20px; backdrop-filter:blur(8px); background: rgba(255,255,255,0.85);">
        <div class="card-body text-center">
          <h5 class="fw-bold text-secondary mb-2" style="font-family: 'Poppins', sans-serif;">📅 Today's Workout Logs</h5>
          <p class="text-muted small">No logs yet for today. Get moving! 💪</p>
        </div>
      </div>
    `;
    return;
  }

  let html = `
    <div class="card shadow-sm mb-3" style="border-radius:20px; backdrop-filter:blur(8px); background: rgba(255,255,255,0.9);">
      <div class="card-body">
        <h5 class="fw-bold mb-3" style="font-family: 'Poppins', sans-serif; color:#0072ff;">📅 Today's Workout Logs — ${todayStr}</h5>
        <ul class="list-group list-group-flush small">
  `;

  todaysLogs.forEach(l => {
    const ex = LEVELS.flatMap(lv => lv.exercises).find(e => e.id === l.exercise);
    html += `
      <li class="list-group-item d-flex justify-content-between align-items-center" style="border:none; border-bottom:1px solid #e0e0e0; font-family: 'Poppins', sans-serif;">
        <span>💪 ${ex ? ex.title : l.exercise}</span>
        <span class="badge bg-success rounded-pill">${l.sets}×${l.reps}</span>
      </li>
    `;
  });

  html += `</ul></div></div>`;
  container.innerHTML = html;
}


window.addEventListener("scroll", () => {
  const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
  const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  const scrollPercent = (scrollTop / scrollHeight) * 100;
  document.getElementById("scrollProgress").style.width = scrollPercent + "%";
});


let logoutTimer;

function startAutoLogoutTimer() {
  // Clear any existing timer first
  if(logoutTimer) clearTimeout(logoutTimer);

  // Set 10-minute timer (600,000 ms)
  logoutTimer = setTimeout(() => {
    Swal.fire({
      icon: 'warning',
      title: 'Session Expired',
      text: 'You have been logged out after 10 minutes of inactivity.',
      timer: 2500,
      showConfirmButton: false
    }).then(() => {
      logout();
    });
  }, 600000);
}


// Optional: Reset timer on user activity (click/keypress)
document.addEventListener("click", startAutoLogoutTimer);
document.addEventListener("keypress", startAutoLogoutTimer);

function renderStats() {
  const level = LEVELS[user.level];
  const totalPushups = user.totalPushups || 0;
  const streak = user.streak || 0;

  // mastery-based progress calculation
  const totalExercises = level.exercises.length;
  const masteredCount = level.exercises.filter(ex => user.masteredExercises.includes(ex.id)).length;
  const progressPercent = Math.round((masteredCount / totalExercises) * 100);

  const nextLevel = user.level < LEVELS.length - 1 ? LEVELS[user.level + 1].name : "Maxed Out!";

  let html = `
    <div class="stats-card" style="
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(12px);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      position: relative;
      font-family: 'Poppins', sans-serif;
    ">
      <div style="background: linear-gradient(135deg,#ff512f,#dd2476);
                  color:white; padding:12px 18px;
                  border-radius:14px; margin-bottom:18px;
                  font-family: 'Orbitron', sans-serif;
                  letter-spacing: 1px;">
        <h5 class="mb-0" style="font-weight:700; font-size:1.3rem;">
          📊 Progress Overview
        </h5>
      </div>

      <p style="font-size:1rem;"><strong>Total Pushups:</strong> <span class="text-success fw-bold" style="font-family:'Roboto Slab', serif;">${totalPushups}</span></p>
      <p style="font-size:1rem;"><strong>Streak:</strong> <span class="text-danger fw-bold" style="font-family:'Roboto Slab', serif;">🔥 ${streak} day(s)</span></p>
      <p style="font-size:1rem;"><strong>Next Level:</strong> <span class="text-info fw-bold" style="font-family:'Roboto Slab', serif;">${nextLevel}</span></p>

      <!-- Striped & Animated Progress Bar -->
      <div class="progress mb-3" style="height: 25px; border-radius: 14px; overflow:hidden;">
        <div class="progress-bar progress-bar-striped progress-bar-animated bg-success fw-bold"
             role="progressbar"
             style="width:${progressPercent}%; font-size:0.9rem; font-family:'Orbitron', sans-serif;">
          ${progressPercent}%
        </div>
      </div>

      <p class="small text-muted" style="font-style:italic;">
        ${masteredCount}/${totalExercises} exercises mastered in this level
      </p>
  `;

  // show milestones if unlocked
  const unlocked = Object.keys(user.milestones).filter(id => user.milestones[id]);
  if (unlocked.length) {
    html += `<h6 class="fw-bold text-success mt-3" style="font-family:'Orbitron', sans-serif; font-size:1.1rem;">
               🏆 Achievements
             </h6>
             <div style="display:flex; flex-wrap:wrap; gap:10px;">`;
    unlocked.forEach(id => {
      const ms = MILESTONES.find(m => m.id === id);
      if (ms) {
        html += `<div style="
          background:#fff;
          border:2px solid #28a745;
          border-radius:12px;
          padding:10px 14px;
          font-size:0.9rem;
          font-weight:600;
          font-family:'Poppins', sans-serif;
          color:#28a745;
          box-shadow:0 2px 6px rgba(0,0,0,0.1);
          transition:transform 0.2s;
        " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
          🏅 ${ms.text}
        </div>`;
      }
    });
    html += `</div>`;
  }

  // motivational line
  html += `<p class="mt-4 text-center fw-bold" 
              style="color:#dd2476; font-family:'Orbitron', sans-serif; font-size:1.1rem;">
            🚀 Keep pushing, greatness is one rep away!
           </p>`;

  html += `</div>`;
  document.getElementById("statsSection").innerHTML = html;
}



function renderCalendar() {
  const calendarEl = document.getElementById("calendar");
  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth();

  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);

  const startDay = firstDay.getDay();
  const totalDays = lastDay.getDate();

  let html = `
    <div class="card shadow calendar-card">
      <div class="card-body">
        <h3 class="calendar-title text-center mb-3">${now.toLocaleString("default", { month: "long" })} ${year}</h3>
        <div class="table-responsive">
          <table class="table table-borderless text-center">
            <thead>
              <tr>
                <th>Sun</th><th>Mon</th><th>Tue</th>
                <th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
              </tr>
            </thead>
            <tbody>
  `;

  let day = 1;
  for (let row = 0; row < 6; row++) {
    html += "<tr>";
    for (let col = 0; col < 7; col++) {
      if (row === 0 && col < startDay || day > totalDays) {
        html += "<td></td>";
      } else {
        const dateStr = `${year}-${String(month + 1).padStart(2,"0")}-${String(day).padStart(2,"0")}`;
        const logged = user.logs.some(l => new Date(l.date).toDateString() === new Date(dateStr).toDateString());

        html += `
          <td>
            <div class="day-circle ${logged ? 'logged' : 'not-logged'}">
              ${day}
            </div>
          </td>
        `;
        day++;
      }
    }
    html += "</tr>";
    if (day > totalDays) break;
  }

  html += `
            </tbody>
          </table>
          <div class="d-flex justify-content-center gap-3 mt-3 legend">
            <span><span class="legend-box logged"></span> Logged</span>
            <span><span class="legend-box not-logged"></span> Not Logged</span>
          </div>
        </div>
      </div>
    </div>
  `;

  calendarEl.innerHTML = html;

  // Add custom styles once
  if (!document.getElementById("calendarStyles")) {
    const style = document.createElement("style");
    style.id = "calendarStyles";
    style.textContent = `
      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap');

      .calendar-card {
        border-radius: 20px;
        overflow: hidden;
        background: rgba(255,255,255,0.9);
        backdrop-filter: blur(8px);
      }

      .calendar-title {
        font-family: 'Poppins', sans-serif;
        font-weight: 700;
        font-size: 1.8rem;
        color: #0072ff;
      }

      table {
        table-layout: fixed;
      }

      th {
        font-family: 'Poppins', sans-serif;
        font-weight: 500;
        color: #555;
        font-size: 0.95rem;
      }

      td {
        padding: 8px;
      }

      .day-circle {
        width: 38px;
        height: 38px;
        line-height: 38px;
        border-radius: 50%;
        font-weight: 600;
        font-family: 'Poppins', sans-serif;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .day-circle.logged {
        background: linear-gradient(135deg, #28a745, #218838);
        color: white;
        box-shadow: 0 4px 10px rgba(40,167,69,0.4);
      }

      .day-circle.not-logged {
        background: #dc3545;
        color: white;
        box-shadow: 0 4px 10px rgba(220,53,69,0.4);
      }

      .day-circle:hover {
        transform: scale(1.15);
        box-shadow: 0 6px 15px rgba(0,0,0,0.25);
        cursor: pointer;
      }

      .legend {
        font-family: 'Poppins', sans-serif;
        font-size: 0.9rem;
      }

      .legend-box {
        display: inline-block;
        width: 16px;
        height: 16px;
        border-radius: 4px;
        margin-right: 5px;
        vertical-align: middle;
      }

      .legend-box.logged {
        background: linear-gradient(135deg, #28a745, #218838);
      }

      .legend-box.not-logged {
        background: #dc3545;
      }
    `;
    document.head.appendChild(style);
  }
}



function saveUser(){ localStorage.setItem("pushUser",JSON.stringify(user)); }

function rotateQuotes() {
  let i = 0;
  const motivation = document.getElementById("motivation");

  // Initial quote
  motivation.textContent = QUOTES[i];
  motivation.style.opacity = 1;

  setInterval(() => {
    // Fade out
    motivation.style.transition = "opacity 0.8s ease";
    motivation.style.opacity = 0;

    setTimeout(() => {
      // Change quote
      i = (i + 1) % QUOTES.length;
      motivation.textContent = QUOTES[i];

      // Highlight special quotes
      if (i % 3 === 0) {
        motivation.classList.add("highlight");
      } else {
        motivation.classList.remove("highlight");
      }

      // Fade in
      motivation.style.opacity = 1;
    }, 800);
  }, 5000);
}


render();
rotateQuotes();
</script>
</body>
</html>

